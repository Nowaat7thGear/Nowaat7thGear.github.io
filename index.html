<!DOCTYPE html>
<html>
  <head>
    <title>7thgear.ai</title>
    <link rel="icon" type="image/x-icon" href="./assets/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="styles.module.css" />
  </head>
  <body>
    <section id="header-placeholder"></section>
    <section id="goals-placeholder"></section>
    <section id="aiAssitance-placeholder"></section>
    <section id="analytics-placeholder"></section>
    <section id="feedback-placeholder"></section>
    <section id="integration-placeholder"></section>
    <section id="footer-placeholder"></section>
    <div class="main">
      <form
        name="user_interested_form"
        id="email_form"
        target="response_iframe"
        action="https://docs.google.com/forms/d/e/1FAIpQLSenyJoQ2hQkkBGfj2C5HQ0dFJNep7sbEBVh_ENjFHKwzAHHGw/formResponse"
        style="display: block"
      >
        <input
          type="email"
          id="email"
          name="entry.245439686"
          placeholder="Enter your work email"
          maxlength="256"
          autocomplete="off"
          required
        />
        <input type="submit" id="submit" value="Request Early Access" />
      </form>
      <div id="submit_msg" style="display: none">
        Thank you for your interest! We will be in touch soon.
      </div>
    </div>

    <iframe id="response_iframe" name="response_iframe"></iframe>
    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function () {
        fetch("header.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("header-placeholder").innerHTML = html;
          });
        fetch("/landingPage/goals.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("goals-placeholder").innerHTML = html;
          });
        fetch("/landingPage/aiAssistance.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("aiAssitance-placeholder").innerHTML = html;
          });
        fetch("/landingPage/analytics.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("analytics-placeholder").innerHTML = html;
          });
        fetch("/landingPage/feedback.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("feedback-placeholder").innerHTML = html;
          });
        fetch("/landingPage/integration.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("integration-placeholder").innerHTML = html;
          });
        fetch("footer.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("footer-placeholder").innerHTML = html;
            var currentYear = new Date().getFullYear();
            document.getElementById("copyright_year").innerText = currentYear;
          });
      });
      var emailFormEl = document.getElementById("email_form");
      var emailInputEl = document.getElementById("email");
      var submitBtnEl = document.getElementById("submit");
      var submitMsgEl = document.getElementById("submit_msg");
      var iframeEl = document.getElementById("response_iframe");
      var emailFormSubmitted = false; // Flag to track form submission

      // set the target on the form to point to a hidden iframe
      // some browsers need the target set via JavaScript, no idea why...
      emailFormEl.target = "response_iframe";
      emailFormEl.addEventListener("submit", function () {
        emailFormSubmitted = true; // Set flag to true when form is submitted
        submitBtnEl.disabled = true;
        submitBtnEl.value = "Requesting...";
      });

      // detect when the iframe reloads
      if (iframeEl) {
        iframeEl.onload = function () {
          if (emailFormSubmitted) {
            // now you can do stuff, such as displaying a message or redirecting to a new page.
            submitMsgEl.style.display = "flex";
            emailFormEl.parentNode.removeChild(emailFormEl);
            iframeEl.parentNode.removeChild(iframeEl); // iframe deletion is a workaround to bypass firefox bug
          }
        };
      }
    </script>
  </body>
</html>
